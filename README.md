# ğŸ¤– Slack AI Assistant v2

> **An intelligent Slack bot powered by RAG (Retrieval Augmented Generation), Long-Term Memory, and MCP (Model Context Protocol) for GitHub & Notion integration.**

[![Node.js](https://img.shields.io/badge/Node.js-18%2B-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.x-blue.svg)](https://www.typescriptlang.org/)
[![Slack](https://img.shields.io/badge/Slack-Bolt.js-purple.svg)](https://slack.dev/bolt-js/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [Features](#-features)
- [Architecture](#-architecture)
  - [High-Level Architecture](#high-level-architecture)
  - [Component Deep Dive](#component-deep-dive)
- [How It Works](#-how-it-works)
  - [Message Processing Flow](#message-processing-flow)
  - [RAG System](#1-rag-retrieval-augmented-generation)
  - [Memory System](#2-memory-system-mem0)
  - [MCP Integration](#3-mcp-model-context-protocol)
- [Installation](#-installation)
- [Configuration](#-configuration)
- [Usage Examples](#-usage-examples)
- [Available Tools](#-available-tools)
- [Project Structure](#-project-structure)
- [Troubleshooting](#-troubleshooting)
- [Contributing](#-contributing)
- [License](#-license)

---

## ğŸŒŸ Overview

This Slack AI Assistant is a production-grade conversational AI that combines three powerful systems:

| System | Purpose | Technology |
|--------|---------|------------|
| **RAG** | Search & retrieve historical Slack messages | Vector embeddings + Semantic search |
| **Memory** | Remember user preferences & context across sessions | mem0.ai cloud |
| **MCP** | Interact with external tools (GitHub, Notion) | Model Context Protocol |

### What Makes This Special?

```
Traditional Bot:  User â†’ LLM â†’ Response (no context, no memory, no tools)

This Bot:         User â†’ Memory Recall â†’ RAG Context â†’ LLM + 59 Tools â†’ Action â†’ Memory Storage
                         â†“                â†“                    â†“
                   "User prefers..."  "In Slack on Oct 5..."  "Created GitHub issue #42"
```

---

## âœ¨ Features

### ğŸ” RAG (Retrieval Augmented Generation)
- **Semantic search** across indexed Slack messages
- **Background indexing** of channels (runs every 60 minutes)
- **Smart retrieval** with relevance scoring
- Works even when bot can't access live channel

### ğŸ§  Long-Term Memory
- **Automatic fact extraction** from conversations
- **Personalized responses** based on user history
- **User-controlled** - view, add, or delete memories
- **Cross-session persistence** - remembers across conversations

### ğŸ”Œ MCP (Model Context Protocol)
- **GitHub Integration** (26 tools)
  - Search repositories, create issues, read files
  - List PRs, commits, manage code
- **Notion Integration** (21 tools)
  - Search pages, query databases
  - Read and update content

### ğŸ’¬ Slack Features
- **DM conversations** with pairing/approval system
- **Channel mentions** with @bot
- **Thread summarization** with `/summarize`
- **Message scheduling** and reminders
- **Typing indicators** and reactions

---

## ğŸ— Architecture

### High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              SLACK WORKSPACE                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  #general   â”‚  â”‚  #dev-team  â”‚  â”‚    DMs      â”‚  â”‚  @mentions  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚                â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SLACK BOLT.JS (Socket Mode)                            â”‚
â”‚                              Event Handler Layer                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AI AGENT (GPT-4o)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         CONTEXT ASSEMBLY                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â”‚
â”‚  â”‚  â”‚   MEMORY     â”‚  â”‚     RAG      â”‚  â”‚   SESSION    â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚   CONTEXT    â”‚  â”‚   CONTEXT    â”‚  â”‚   HISTORY    â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚ "User is     â”‚  â”‚ "On Oct 5,   â”‚  â”‚ Last 10      â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚  co-founder  â”‚  â”‚  team said   â”‚  â”‚ messages     â”‚                   â”‚   â”‚
â”‚  â”‚  â”‚  of Vizuara" â”‚  â”‚  about..."   â”‚  â”‚ in thread    â”‚                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                            â”‚
â”‚                                    â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         59 AVAILABLE TOOLS                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚  SLACK TOOLS   â”‚  â”‚  GITHUB TOOLS  â”‚  â”‚  NOTION TOOLS  â”‚             â”‚   â”‚
â”‚  â”‚  â”‚   (12 tools)   â”‚  â”‚   (26 tools)   â”‚  â”‚   (21 tools)   â”‚             â”‚   â”‚
â”‚  â”‚  â”‚                â”‚  â”‚                â”‚  â”‚                â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ search_kb    â”‚  â”‚ â€¢ create_issue â”‚  â”‚ â€¢ search       â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ send_message â”‚  â”‚ â€¢ list_repos   â”‚  â”‚ â€¢ get_page     â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ get_history  â”‚  â”‚ â€¢ get_file     â”‚  â”‚ â€¢ query_db     â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ schedule     â”‚  â”‚ â€¢ list_PRs     â”‚  â”‚ â€¢ create_page  â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ remind       â”‚  â”‚ â€¢ search_code  â”‚  â”‚ â€¢ update       â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ memory ops   â”‚  â”‚ â€¢ ...          â”‚  â”‚ â€¢ ...          â”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                         â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   VECTOR STORE   â”‚    â”‚   MEM0 CLOUD     â”‚    â”‚   MCP SERVERS    â”‚
â”‚   (ChromaDB)     â”‚    â”‚                  â”‚    â”‚                  â”‚
â”‚                  â”‚    â”‚                  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  254 indexed     â”‚    â”‚  User memories   â”‚    â”‚  â”‚   GitHub   â”‚  â”‚
â”‚  Slack messages  â”‚    â”‚  & preferences   â”‚    â”‚  â”‚   Server   â”‚  â”‚
â”‚                  â”‚    â”‚                  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Embeddings:     â”‚    â”‚  Extraction:     â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  OpenAI          â”‚    â”‚  gpt-4o-mini     â”‚    â”‚  â”‚   Notion   â”‚  â”‚
â”‚  text-embed-3    â”‚    â”‚                  â”‚    â”‚  â”‚   Server   â”‚  â”‚
â”‚                  â”‚    â”‚                  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                         â”‚                         â”‚
          â”‚                         â”‚                         â”‚
          â–¼                         â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   LOCAL DISK     â”‚    â”‚   MEM0 API       â”‚    â”‚  EXTERNAL APIs   â”‚
â”‚   ./data/        â”‚    â”‚   (Cloud)        â”‚    â”‚  GitHub, Notion  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Component Deep Dive

#### 1. Slack Layer (`src/channels/slack.ts`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SLACK EVENT HANDLER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  INCOMING EVENTS:                                               â”‚
â”‚  â”œâ”€â”€ message (DM)        â†’ Check approval â†’ Process             â”‚
â”‚  â”œâ”€â”€ message (channel)   â†’ Check @mention â†’ Process             â”‚
â”‚  â”œâ”€â”€ app_mention         â†’ Process directly                     â”‚
â”‚  â”œâ”€â”€ reaction_added      â†’ Log/handle                           â”‚
â”‚  â””â”€â”€ slash_commands      â†’ /approve, /status                    â”‚
â”‚                                                                 â”‚
â”‚  SPECIAL HANDLERS:                                              â”‚
â”‚  â”œâ”€â”€ "help"              â†’ Show help message                    â”‚
â”‚  â”œâ”€â”€ "summarize"/"tldr"  â†’ Summarize thread                     â”‚
â”‚  â”œâ”€â”€ "my tasks"          â†’ List scheduled tasks                 â”‚
â”‚  â”œâ”€â”€ "cancel task N"     â†’ Cancel task                          â”‚
â”‚  â””â”€â”€ "/reset"            â†’ Clear conversation                   â”‚
â”‚                                                                 â”‚
â”‚  REGULAR FLOW:                                                  â”‚
â”‚  â””â”€â”€ All other messages  â†’ processMessage() in agent.ts        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. Agent Layer (`src/agents/agent.ts`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI AGENT                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  processMessage(userMessage, context)                           â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ 1. MEMORY RETRIEVAL                                        â”‚
â”‚  â”‚   â””â”€â”€ searchMemory(message, userId) â†’ memoryContext          â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ 2. RAG PRE-CHECK                                           â”‚
â”‚  â”‚   â””â”€â”€ shouldUseRAG(message) ? retrieve() â†’ ragContext        â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ 3. BUILD MESSAGES                                          â”‚
â”‚  â”‚   â”œâ”€â”€ System prompt (with tool instructions)                 â”‚
â”‚  â”‚   â”œâ”€â”€ Memory context (if found)                              â”‚
â”‚  â”‚   â”œâ”€â”€ RAG context (if found)                                 â”‚
â”‚  â”‚   â”œâ”€â”€ Session history (last 10 messages)                     â”‚
â”‚  â”‚   â””â”€â”€ Current user message                                   â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ 4. GET ALL TOOLS                                           â”‚
â”‚  â”‚   â”œâ”€â”€ SLACK_TOOLS (12 built-in)                              â”‚
â”‚  â”‚   â””â”€â”€ MCP_TOOLS (47 from GitHub + Notion)                    â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ 5. LLM CALL (GPT-4o)                                       â”‚
â”‚  â”‚   â””â”€â”€ Loop while tool_calls exist:                           â”‚
â”‚  â”‚       â”œâ”€â”€ Execute tool (Slack or MCP)                        â”‚
â”‚  â”‚       â”œâ”€â”€ Add result to messages                             â”‚
â”‚  â”‚       â””â”€â”€ Call LLM again                                     â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ 6. MEMORY STORAGE (async, background)                      â”‚
â”‚  â”‚   â””â”€â”€ addMemory(conversation) â†’ extract & store facts        â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€â”€ 7. RETURN RESPONSE                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. Tool Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TOOL EXECUTION                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  executeTool(name, args, context)                               â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â”€ SLACK TOOLS (handled directly):                            â”‚
â”‚  â”‚   â”œâ”€â”€ search_knowledge_base â†’ RAG retrieve()                 â”‚
â”‚  â”‚   â”œâ”€â”€ send_message â†’ Slack API                               â”‚
â”‚  â”‚   â”œâ”€â”€ get_channel_history â†’ Slack API                        â”‚
â”‚  â”‚   â”œâ”€â”€ schedule_message â†’ Slack API                           â”‚
â”‚  â”‚   â”œâ”€â”€ set_reminder â†’ Slack API                               â”‚
â”‚  â”‚   â”œâ”€â”€ list_channels â†’ Slack API                              â”‚
â”‚  â”‚   â”œâ”€â”€ list_users â†’ Slack API                                 â”‚
â”‚  â”‚   â”œâ”€â”€ get_my_memories â†’ mem0 getAllMemories()                â”‚
â”‚  â”‚   â”œâ”€â”€ remember_this â†’ mem0 addMemory()                       â”‚
â”‚  â”‚   â”œâ”€â”€ forget_about â†’ mem0 deleteMemory()                     â”‚
â”‚  â”‚   â””â”€â”€ forget_everything â†’ mem0 deleteAllMemories()           â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€â”€ MCP TOOLS (routed to MCP servers):                         â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€â”€ parseToolName("github_create_issue")                   â”‚
â”‚      â”‚   â””â”€â”€ { serverName: "github", toolName: "create_issue" } â”‚
â”‚      â”‚                                                          â”‚
â”‚      â””â”€â”€ executeMCPTool(serverName, toolName, args)             â”‚
â”‚          â””â”€â”€ Send JSON-RPC to MCP server process                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ How It Works

### Message Processing Flow

When a user sends a message, here's the complete flow:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER: "Search Slack for bugs we discussed, then create GitHub issues for them" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: SLACK EVENT RECEIVED                                                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚ â€¢ Slack Bolt.js receives message event                                          â”‚
â”‚ â€¢ Validates: Is this a DM? Is user approved? Is bot mentioned?                  â”‚
â”‚ â€¢ Adds ğŸ‘€ reaction to show processing                                           â”‚
â”‚ â€¢ Creates/retrieves session for conversation continuity                         â”‚
â”‚                                                                                 â”‚
â”‚ Log: "Message received from U050Y4SNQF3 in D0AB0RYJTRR"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: MEMORY RETRIEVAL                                                        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚ â€¢ Query mem0 for relevant memories about this user                              â”‚
â”‚ â€¢ Semantic search: "What do I know that's relevant to this message?"            â”‚
â”‚ â€¢ Returns: User preferences, past context, stored facts                         â”‚
â”‚                                                                                 â”‚
â”‚ Example memories found:                                                         â”‚
â”‚ â€¢ "User's GitHub username is VizuaraAI"                                         â”‚
â”‚ â€¢ "User prefers detailed technical explanations"                                â”‚
â”‚ â€¢ "User is co-founder of Vizuara AI Labs"                                       â”‚
â”‚                                                                                 â”‚
â”‚ Log: "Retrieved 3 relevant memories"                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: RAG PRE-CHECK                                                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚ â€¢ Analyze message: Does it ask about past discussions?                          â”‚
â”‚ â€¢ Keywords: "discussed", "talked about", "mentioned", "said", etc.              â”‚
â”‚ â€¢ If yes: Query vector store for relevant Slack messages                        â”‚
â”‚                                                                                 â”‚
â”‚ â€¢ Query: "bugs we discussed"                                                    â”‚
â”‚ â€¢ Vector search across 254 indexed messages                                     â”‚
â”‚ â€¢ Returns top matches with relevance scores                                     â”‚
â”‚                                                                                 â”‚
â”‚ Log: "RAG triggered for query"                                                  â”‚
â”‚ Log: "Retrieved 5 documents in 384ms"                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: BUILD LLM CONTEXT                                                       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚                                                                                 â”‚
â”‚ Messages array sent to GPT-4o:                                                  â”‚
â”‚                                                                                 â”‚
â”‚ [                                                                               â”‚
â”‚   {                                                                             â”‚
â”‚     role: "system",                                                             â”‚
â”‚     content: "You are a helpful AI assistant...                                 â”‚
â”‚               ## MANDATORY TOOL USAGE...                                        â”‚
â”‚               You have access to GitHub and Notion via tools..."                â”‚
â”‚   },                                                                            â”‚
â”‚   {                                                                             â”‚
â”‚     role: "system",                                                             â”‚
â”‚     content: "## What I Remember About You\n                                    â”‚
â”‚               1. User's GitHub username is VizuaraAI\n                          â”‚
â”‚               2. User prefers detailed explanations..."                         â”‚
â”‚   },                                                                            â”‚
â”‚   {                                                                             â”‚
â”‚     role: "system",                                                             â”‚
â”‚     content: "## Relevant Slack History\n                                       â”‚
â”‚               [Oct 5] @john: Found a bug in the login flow...\n                 â”‚
â”‚               [Oct 7] @jane: The API timeout issue is critical..."              â”‚
â”‚   },                                                                            â”‚
â”‚   { role: "user", content: "What's the weather?" },      // Previous           â”‚
â”‚   { role: "assistant", content: "I can't check..." },    // conversation       â”‚
â”‚   { role: "user", content: "Search Slack for bugs..." }  // Current message    â”‚
â”‚ ]                                                                               â”‚
â”‚                                                                                 â”‚
â”‚ + 59 tool definitions attached                                                  â”‚
â”‚                                                                                 â”‚
â”‚ Log: "Total tools available: 59 (12 Slack + 47 MCP)"                            â”‚
â”‚ Log: "Calling LLM with 59 tools"                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: LLM DECISION & TOOL CALLS                                               â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                               â”‚
â”‚                                                                                 â”‚
â”‚ GPT-4o analyzes the request and decides to call tools:                          â”‚
â”‚                                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LLM Response #1:                                                            â”‚ â”‚
â”‚ â”‚ {                                                                           â”‚ â”‚
â”‚ â”‚   tool_calls: [                                                             â”‚ â”‚
â”‚ â”‚     {                                                                       â”‚ â”‚
â”‚ â”‚       function: "search_knowledge_base",                                    â”‚ â”‚
â”‚ â”‚       arguments: { query: "bugs", limit: 10 }                               â”‚ â”‚
â”‚ â”‚     }                                                                       â”‚ â”‚
â”‚ â”‚   ]                                                                         â”‚ â”‚
â”‚ â”‚ }                                                                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ TOOL EXECUTION: search_knowledge_base                                       â”‚ â”‚
â”‚ â”‚ â€¢ RAG query: "bugs"                                                         â”‚ â”‚
â”‚ â”‚ â€¢ Returns: 10 relevant messages about bugs                                  â”‚ â”‚
â”‚ â”‚                                                                             â”‚ â”‚
â”‚ â”‚ Log: "Executing tool: search_knowledge_base"                                â”‚ â”‚
â”‚ â”‚ Log: "RAG search returned 10 results"                                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LLM Response #2 (with tool results):                                        â”‚ â”‚
â”‚ â”‚ {                                                                           â”‚ â”‚
â”‚ â”‚   tool_calls: [                                                             â”‚ â”‚
â”‚ â”‚     {                                                                       â”‚ â”‚
â”‚ â”‚       function: "github_create_issue",                                      â”‚ â”‚
â”‚ â”‚       arguments: {                                                          â”‚ â”‚
â”‚ â”‚         owner: "VizuaraAI",                                                 â”‚ â”‚
â”‚ â”‚         repo: "nano-kimi",                                                  â”‚ â”‚
â”‚ â”‚         title: "Fix login timeout bug",                                     â”‚ â”‚
â”‚ â”‚         body: "As discussed on Oct 5..."                                    â”‚ â”‚
â”‚ â”‚       }                                                                     â”‚ â”‚
â”‚ â”‚     },                                                                      â”‚ â”‚
â”‚ â”‚     {                                                                       â”‚ â”‚
â”‚ â”‚       function: "github_create_issue",                                      â”‚ â”‚
â”‚ â”‚       arguments: { ... another issue ... }                                  â”‚ â”‚
â”‚ â”‚     }                                                                       â”‚ â”‚
â”‚ â”‚   ]                                                                         â”‚ â”‚
â”‚ â”‚ }                                                                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ TOOL EXECUTION: github_create_issue (via MCP)                               â”‚ â”‚
â”‚ â”‚ â€¢ Route to MCP client                                                       â”‚ â”‚
â”‚ â”‚ â€¢ MCP client sends JSON-RPC to GitHub server                                â”‚ â”‚
â”‚ â”‚ â€¢ GitHub server calls GitHub API                                            â”‚ â”‚
â”‚ â”‚ â€¢ Returns: { issue_number: 42, url: "..." }                                 â”‚ â”‚
â”‚ â”‚                                                                             â”‚ â”‚
â”‚ â”‚ Log: "Executing MCP tool: github/create_issue"                              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LLM Response #3 (final):                                                    â”‚ â”‚
â”‚ â”‚ {                                                                           â”‚ â”‚
â”‚ â”‚   content: "I searched Slack and found 10 discussions about bugs.           â”‚ â”‚
â”‚ â”‚             I've created 2 GitHub issues:\n                                 â”‚ â”‚
â”‚ â”‚             â€¢ #42: Fix login timeout bug\n                                  â”‚ â”‚
â”‚ â”‚             â€¢ #43: API response caching issue"                              â”‚ â”‚
â”‚ â”‚ }                                                                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: MEMORY STORAGE (Background)                                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚                                                                                 â”‚
â”‚ â€¢ After response is sent, analyze conversation for facts                        â”‚
â”‚ â€¢ mem0 extracts: "User asked about bugs in Slack discussions"                   â”‚
â”‚ â€¢ Stores for future context                                                     â”‚
â”‚                                                                                 â”‚
â”‚ Log: "Stored 1 memories for user U050Y4SNQF3"                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: SEND RESPONSE                                                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚                                                                                 â”‚
â”‚ â€¢ Remove ğŸ‘€ reaction                                                            â”‚
â”‚ â€¢ Send formatted response to Slack                                              â”‚
â”‚ â€¢ Thread if needed (long response or existing thread)                           â”‚
â”‚                                                                                 â”‚
â”‚ Final message to user:                                                          â”‚
â”‚ "I searched Slack and found 10 discussions about bugs.                          â”‚
â”‚  I've created 2 GitHub issues:                                                  â”‚
â”‚  â€¢ #42: Fix login timeout bug                                                   â”‚
â”‚  â€¢ #43: API response caching issue"                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1. RAG (Retrieval Augmented Generation)

#### What is RAG?

RAG allows the bot to search through historical Slack messages and use them as context for responses. Instead of the LLM making up information, it retrieves real data from your workspace.

#### How RAG Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              RAG PIPELINE                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            INDEXING PHASE (Background)
                            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SLACK     â”‚     â”‚   MESSAGE    â”‚     â”‚  EMBEDDING   â”‚     â”‚   VECTOR     â”‚
â”‚   CHANNELS   â”‚â”€â”€â”€â”€â–¶â”‚  EXTRACTOR   â”‚â”€â”€â”€â”€â–¶â”‚   MODEL      â”‚â”€â”€â”€â”€â–¶â”‚    STORE     â”‚
â”‚              â”‚     â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â”‚ #general     â”‚     â”‚ â€¢ Text       â”‚     â”‚ OpenAI       â”‚     â”‚ ChromaDB     â”‚
â”‚ #dev-team    â”‚     â”‚ â€¢ User       â”‚     â”‚ text-embed-  â”‚     â”‚ (Local)      â”‚
â”‚ #random      â”‚     â”‚ â€¢ Timestamp  â”‚     â”‚ 3-small      â”‚     â”‚              â”‚
â”‚              â”‚     â”‚ â€¢ Channel    â”‚     â”‚              â”‚     â”‚ 254 docs     â”‚
â”‚              â”‚     â”‚ â€¢ Thread     â”‚     â”‚ 1536 dims    â”‚     â”‚ indexed      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            RETRIEVAL PHASE (Query Time)
                            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    USER      â”‚     â”‚  EMBEDDING   â”‚     â”‚   VECTOR     â”‚     â”‚   RANKED     â”‚
â”‚    QUERY     â”‚â”€â”€â”€â”€â–¶â”‚   MODEL      â”‚â”€â”€â”€â”€â–¶â”‚   SEARCH     â”‚â”€â”€â”€â”€â–¶â”‚   RESULTS    â”‚
â”‚              â”‚     â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â”‚ "What bugs   â”‚     â”‚ Same model   â”‚     â”‚ Cosine       â”‚     â”‚ Top 10 most  â”‚
â”‚  did we      â”‚     â”‚ as indexing  â”‚     â”‚ similarity   â”‚     â”‚ relevant     â”‚
â”‚  discuss?"   â”‚     â”‚              â”‚     â”‚              â”‚     â”‚ messages     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### RAG Configuration

| Setting | Default | Description |
|---------|---------|-------------|
| `RAG_ENABLED` | `true` | Enable/disable RAG |
| `RAG_EMBEDDING_MODEL` | `text-embedding-3-small` | OpenAI embedding model |
| `RAG_MAX_RESULTS` | `10` | Max documents to retrieve |
| `RAG_MIN_SIMILARITY` | `0.3` | Minimum relevance score (0-1) |
| `RAG_INDEX_INTERVAL_MINUTES` | `60` | How often to re-index |

#### Key Files

- `src/rag/vectorstore.ts` - Vector storage (ChromaDB)
- `src/rag/embeddings.ts` - OpenAI embeddings
- `src/rag/indexer.ts` - Background message indexer
- `src/rag/retriever.ts` - Semantic search

---

### 2. Memory System (mem0)

#### What is mem0?

mem0 is a cloud-based memory system that automatically extracts and stores facts from conversations. It enables the bot to remember user preferences, context, and history across sessions.

#### How Memory Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            MEMORY PIPELINE                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            STORAGE PHASE (After Response)
                            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONVERSATION â”‚     â”‚    GPT-4o    â”‚     â”‚    FACT      â”‚     â”‚   MEM0       â”‚
â”‚              â”‚â”€â”€â”€â”€â–¶â”‚    MINI      â”‚â”€â”€â”€â”€â–¶â”‚  EXTRACTION  â”‚â”€â”€â”€â”€â–¶â”‚   CLOUD      â”‚
â”‚              â”‚     â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â”‚ User: "My    â”‚     â”‚ Analyzes     â”‚     â”‚ Extracted:   â”‚     â”‚ Stores per   â”‚
â”‚  GitHub is   â”‚     â”‚ conversation â”‚     â”‚ "User's      â”‚     â”‚ user_id      â”‚
â”‚  VizuaraAI"  â”‚     â”‚ for facts    â”‚     â”‚  GitHub is   â”‚     â”‚              â”‚
â”‚              â”‚     â”‚              â”‚     â”‚  VizuaraAI"  â”‚     â”‚ Searchable   â”‚
â”‚ Bot: "Got    â”‚     â”‚              â”‚     â”‚              â”‚     â”‚ via API      â”‚
â”‚  it!"        â”‚     â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            RETRIEVAL PHASE (Before LLM Call)
                            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    USER      â”‚     â”‚   MEM0       â”‚     â”‚  SEMANTIC    â”‚     â”‚  MEMORY      â”‚
â”‚   MESSAGE    â”‚â”€â”€â”€â”€â–¶â”‚   CLOUD      â”‚â”€â”€â”€â”€â–¶â”‚   SEARCH     â”‚â”€â”€â”€â”€â–¶â”‚  CONTEXT     â”‚
â”‚              â”‚     â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â”‚ "List my     â”‚     â”‚ Query by     â”‚     â”‚ Find         â”‚     â”‚ "User's      â”‚
â”‚  repos"      â”‚     â”‚ user_id +    â”‚     â”‚ relevant     â”‚     â”‚  GitHub is   â”‚
â”‚              â”‚     â”‚ semantic     â”‚     â”‚ memories     â”‚     â”‚  VizuaraAI"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                      â”‚
                                                                      â–¼
                                                              Added to LLM context
```

#### Memory Types

| Type | Example | How It's Used |
|------|---------|---------------|
| **Preferences** | "User prefers concise responses" | Adjusts response style |
| **Identity** | "User is co-founder of Vizuara" | Personalizes context |
| **Technical** | "User's GitHub is VizuaraAI" | Pre-fills tool arguments |
| **Projects** | "User is working on nano-kimi" | Understands context |
| **Interests** | "User cares about SOP, LOR" | Prioritizes topics |

#### Memory Tools (User-Controlled)

```
"What do you remember about me?"     â†’ get_my_memories
"Remember that I prefer Python"      â†’ remember_this
"Forget about my old project"        â†’ forget_about
"Forget everything about me"         â†’ forget_everything
```

---

### 3. MCP (Model Context Protocol)

#### What is MCP?

MCP is Anthropic's open standard for connecting AI models to external tools. Instead of hardcoding integrations, MCP provides a standardized protocol for tool discovery and execution.

#### How MCP Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              MCP ARCHITECTURE                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              SLACK BOT PROCESS                                   â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           MCP CLIENT                                     â”‚   â”‚
â”‚  â”‚                        (src/mcp/client.ts)                               â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚   â€¢ Spawns MCP server processes                                          â”‚   â”‚
â”‚  â”‚   â€¢ Discovers available tools                                            â”‚   â”‚
â”‚  â”‚   â€¢ Routes tool calls via JSON-RPC                                       â”‚   â”‚
â”‚  â”‚   â€¢ Handles responses                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                    â”‚           stdio               â”‚                            â”‚
â”‚                    â”‚      (stdin/stdout)           â”‚                            â”‚
â”‚                    â–¼                               â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚      GITHUB MCP SERVER       â”‚  â”‚      NOTION MCP SERVER       â”‚           â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚           â”‚
â”‚  â”‚  npx @modelcontextprotocol/  â”‚  â”‚  npx @notionhq/              â”‚           â”‚
â”‚  â”‚      server-github           â”‚  â”‚      notion-mcp-server       â”‚           â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚           â”‚
â”‚  â”‚  26 tools available:         â”‚  â”‚  21 tools available:         â”‚           â”‚
â”‚  â”‚  â€¢ search_repositories       â”‚  â”‚  â€¢ search                    â”‚           â”‚
â”‚  â”‚  â€¢ create_issue              â”‚  â”‚  â€¢ get_page                  â”‚           â”‚
â”‚  â”‚  â€¢ get_file_contents         â”‚  â”‚  â€¢ query_database            â”‚           â”‚
â”‚  â”‚  â€¢ list_pull_requests        â”‚  â”‚  â€¢ create_page               â”‚           â”‚
â”‚  â”‚  â€¢ ...                       â”‚  â”‚  â€¢ ...                       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                    â”‚                               â”‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                               â”‚
                     â–¼                               â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   GITHUB API     â”‚            â”‚   NOTION API     â”‚
           â”‚                  â”‚            â”‚                  â”‚
           â”‚  api.github.com  â”‚            â”‚  api.notion.com  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### MCP Initialization Flow

```
STARTUP:
â”€â”€â”€â”€â”€â”€â”€â”€
1. Load config (env vars or mcp-config.json)
2. For each server:
   a. Spawn process: npx @modelcontextprotocol/server-xxx
   b. Send: initialize request
   c. Send: notifications/initialized
   d. Send: tools/list
   e. Store discovered tools

TOOL CALL:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. LLM returns: { tool: "github_create_issue", args: {...} }
2. Parse: serverName="github", toolName="create_issue"
3. Find server process
4. Send JSON-RPC: { method: "tools/call", params: { name, arguments } }
5. Wait for response
6. Return result to LLM
```

#### JSON-RPC Communication

```json
// Request (Bot â†’ MCP Server)
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "create_issue",
    "arguments": {
      "owner": "VizuaraAI",
      "repo": "nano-kimi",
      "title": "Fix bug",
      "body": "Description..."
    }
  }
}

// Response (MCP Server â†’ Bot)
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "Created issue #42: https://github.com/..."
      }
    ]
  }
}
```

---

## ğŸ“¦ Installation

### Prerequisites

- Node.js 18+
- npm or yarn
- Slack workspace (admin access)
- OpenAI API key
- GitHub Personal Access Token (for MCP)
- Notion Integration Token (for MCP)
- mem0 API key (for memory)

### Step 1: Clone & Install

```bash
git clone https://github.com/yourusername/slack-ai-assistant-v2.git
cd slack-ai-assistant-v2
npm install
```

### Step 2: Create Slack App

1. Go to [api.slack.com/apps](https://api.slack.com/apps)
2. Click "Create New App" â†’ "From scratch"
3. Enable **Socket Mode** (Settings â†’ Socket Mode)
4. Add **Bot Token Scopes**:
   - `app_mentions:read`
   - `channels:history`
   - `channels:read`
   - `chat:write`
   - `im:history`
   - `im:read`
   - `im:write`
   - `reactions:read`
   - `reactions:write`
   - `reminders:read`
   - `reminders:write`
   - `users:read`
5. Add **User Token Scopes** (for reminders):
   - `reminders:read`
   - `reminders:write`
6. Install to workspace
7. Copy tokens:
   - Bot Token: `xoxb-...`
   - App Token: `xapp-...`
   - User Token: `xoxp-...`

### Step 3: Get API Keys

**OpenAI:**
1. Go to [platform.openai.com](https://platform.openai.com)
2. Create API key

**GitHub:**
1. Go to [github.com/settings/tokens](https://github.com/settings/tokens)
2. Generate new token (classic)
3. Select scopes: `repo`, `issues`

**Notion:**
1. Go to [notion.so/my-integrations](https://www.notion.so/my-integrations)
2. Create new integration
3. Copy Internal Integration Token
4. Share pages with the integration

**mem0:**
1. Go to [app.mem0.ai](https://app.mem0.ai)
2. Create account and get API key

### Step 4: Configure Environment

```bash
cp .env.example .env
```

Edit `.env`:
```env
# Slack
SLACK_BOT_TOKEN=xoxb-your-bot-token
SLACK_APP_TOKEN=xapp-your-app-token
SLACK_USER_TOKEN=xoxp-your-user-token

# AI
OPENAI_API_KEY=sk-your-openai-key
DEFAULT_MODEL=gpt-4o

# Memory
MEM0_API_KEY=m0-your-mem0-key
MEMORY_ENABLED=true

# MCP
GITHUB_PERSONAL_ACCESS_TOKEN=ghp_your_github_token
NOTION_API_TOKEN=secret_your_notion_token

# RAG
RAG_ENABLED=true
```

### Step 5: Run

```bash
# Development (with hot reload)
npm run dev

# Production
npm run build
npm start
```

### Expected Output

```
âœ… Database initialized
âœ… Vector store initialized (254 documents)
âœ… Background indexer started
âœ… Memory system initialized
âœ… MCP initialized: github, notion
âœ… Task scheduler started
âœ… Slack app started

Features enabled:
  â€¢ RAG (Semantic Search): âœ…
  â€¢ Long-Term Memory: âœ…
  â€¢ MCP (GitHub/Notion): âœ… github, notion
  â€¢ Task Scheduler: âœ…
  â€¢ AI Model: gpt-4o

Press Ctrl+C to stop
```

---

## âš™ï¸ Configuration

### Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `SLACK_BOT_TOKEN` | âœ… | - | Bot OAuth token (xoxb-) |
| `SLACK_APP_TOKEN` | âœ… | - | App-level token (xapp-) |
| `SLACK_USER_TOKEN` | âŒ | - | User token for reminders |
| `OPENAI_API_KEY` | âœ… | - | OpenAI API key |
| `DEFAULT_MODEL` | âŒ | `gpt-4o` | AI model to use |
| `MEM0_API_KEY` | âŒ | - | mem0 cloud API key |
| `MEMORY_ENABLED` | âŒ | `true` | Enable memory system |
| `GITHUB_PERSONAL_ACCESS_TOKEN` | âŒ | - | GitHub token for MCP |
| `NOTION_API_TOKEN` | âŒ | - | Notion token for MCP |
| `RAG_ENABLED` | âŒ | `true` | Enable RAG |
| `RAG_INDEX_INTERVAL_MINUTES` | âŒ | `60` | Index frequency |
| `LOG_LEVEL` | âŒ | `info` | Log verbosity |

### MCP Configuration (Optional)

Create `mcp-config.json` for custom MCP settings:

```json
{
  "servers": [
    {
      "name": "github",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "$GITHUB_PERSONAL_ACCESS_TOKEN"
      }
    },
    {
      "name": "notion",
      "command": "npx",
      "args": ["-y", "@notionhq/notion-mcp-server"],
      "env": {
        "OPENAPI_MCP_HEADERS": "{\"Authorization\": \"Bearer $NOTION_API_TOKEN\", \"Notion-Version\": \"2022-06-28\"}"
      }
    }
  ]
}
```

---

## ğŸ’¡ Usage Examples

### Basic Conversations

```
User: Hello!
Bot:  Hi! How can I help you today?

User: What can you do?
Bot:  I can help with:
      â€¢ Searching Slack history for past discussions
      â€¢ Managing GitHub repos, issues, and PRs
      â€¢ Searching and reading Notion pages
      â€¢ Scheduling messages and reminders
      â€¢ Remembering your preferences
```

### RAG (Slack Search)

```
User: What did we discuss about the API last week?
Bot:  Based on Slack history, here's what was discussed:

      [Oct 15] @john: "The API timeout is set to 30s, should increase"
      [Oct 16] @jane: "Agreed, let's make it configurable"
      [Oct 17] @john: "Done, deployed to staging"

      Summary: The team discussed API timeout issues and made it configurable.
```

### Memory

```
User: Remember that I prefer Python over JavaScript
Bot:  âœ… Got it! I'll remember that you prefer Python over JavaScript.

------- Later session -------

User: Write a hello world script
Bot:  Here's a Python hello world (since you prefer Python):
      
      print("Hello, World!")
```

### MCP (GitHub)

```
User: List my GitHub repos
Bot:  Here are your repositories:
      1. nano-kimi - Learn to build nano-kimi from scratch
      2. Mixture_of_Experts - MoE implementation
      3. Machine-Learning-Teach-by-Doing
      ...

User: Create an issue for the login bug
Bot:  âœ… Created issue #42 in VizuaraAI/nano-kimi:
      "Login timeout bug"
      https://github.com/VizuaraAI/nano-kimi/issues/42
```

### MCP (Notion)

```
User: Search Notion for project roadmap
Bot:  Found 3 pages matching "project roadmap":
      1. Q4 Product Roadmap (last edited 2 days ago)
      2. Engineering Roadmap 2024
      3. Roadmap Template

      Would you like me to get the content of any of these?
```

### Combined (RAG + Memory + MCP)

```
User: Remember my GitHub is VizuaraAI. Search Slack for bugs we 
      discussed, then create issues for them.

Bot:  âœ… I'll remember your GitHub username.
      
      Searching Slack for bug discussions...
      Found 10 relevant messages.
      
      Creating GitHub issues:
      â€¢ #42: Login timeout bug (from Oct 5 discussion)
      â€¢ #43: API caching issue (from Oct 12 discussion)
      
      Created 2 issues in VizuaraAI/nano-kimi!
```

---

## ğŸ”§ Available Tools

### Slack Tools (12)

| Tool | Description |
|------|-------------|
| `search_knowledge_base` | Semantic search across indexed Slack messages |
| `send_message` | Send message to channel or user |
| `get_channel_history` | Get recent messages from a channel |
| `schedule_message` | Schedule one-time message |
| `schedule_recurring_message` | Schedule recurring message |
| `set_reminder` | Set a reminder |
| `list_channels` | List all channels |
| `list_users` | List all users |
| `get_my_memories` | Show stored memories |
| `remember_this` | Explicitly store a fact |
| `forget_about` | Delete specific memories |
| `forget_everything` | Delete all memories |

### GitHub Tools via MCP (26)

| Tool | Description |
|------|-------------|
| `github_search_repositories` | Search for repos |
| `github_get_repository` | Get repo details |
| `github_list_issues` | List issues |
| `github_create_issue` | Create new issue |
| `github_get_issue` | Get issue details |
| `github_update_issue` | Update issue |
| `github_list_pull_requests` | List PRs |
| `github_create_pull_request` | Create PR |
| `github_get_file_contents` | Read file from repo |
| `github_search_code` | Search code |
| ... and 16 more |

### Notion Tools via MCP (21)

| Tool | Description |
|------|-------------|
| `notion_search` | Search all pages |
| `notion_get_page` | Get page content |
| `notion_create_page` | Create new page |
| `notion_update_page` | Update page |
| `notion_query_database` | Query database |
| `notion_create_database` | Create database |
| ... and 15 more |

---

## ğŸ“ Project Structure

```
slack-ai-assistant-v2/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                 # Main entry point
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ index.ts             # Configuration loading
â”‚   â”œâ”€â”€ channels/
â”‚   â”‚   â””â”€â”€ slack.ts             # Slack event handlers
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â””â”€â”€ agent.ts             # AI agent + tool orchestration
â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â””â”€â”€ database.ts          # SQLite for sessions
â”‚   â”œâ”€â”€ memory-ai/
â”‚   â”‚   â”œâ”€â”€ index.ts             # Memory exports
â”‚   â”‚   â””â”€â”€ mem0-client.ts       # mem0 integration
â”‚   â”œâ”€â”€ rag/
â”‚   â”‚   â”œâ”€â”€ index.ts             # RAG exports
â”‚   â”‚   â”œâ”€â”€ vectorstore.ts       # ChromaDB storage
â”‚   â”‚   â”œâ”€â”€ embeddings.ts        # OpenAI embeddings
â”‚   â”‚   â”œâ”€â”€ indexer.ts           # Background indexer
â”‚   â”‚   â””â”€â”€ retriever.ts         # Semantic search
â”‚   â”œâ”€â”€ mcp/
â”‚   â”‚   â”œâ”€â”€ index.ts             # MCP exports
â”‚   â”‚   â”œâ”€â”€ client.ts            # MCP client manager
â”‚   â”‚   â”œâ”€â”€ config.ts            # MCP configuration
â”‚   â”‚   â””â”€â”€ tool-converter.ts    # MCP â†’ OpenAI tool format
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ slack-actions.ts     # Slack API wrappers
â”‚   â”‚   â””â”€â”€ scheduler.ts         # Task scheduler
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.ts            # Winston logger
â”œâ”€â”€ data/                        # Local data (gitignored)
â”‚   â””â”€â”€ vectorstore/             # ChromaDB files
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ARCHITECTURE.md          # Architecture details
â”‚   â”œâ”€â”€ RAG.md                   # RAG documentation
â”‚   â”œâ”€â”€ MEMORY.md                # Memory documentation
â”‚   â””â”€â”€ MCP.md                   # MCP documentation
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup-db.ts              # Database setup
â”‚   â””â”€â”€ run-indexer.ts           # Manual indexing
â”œâ”€â”€ .env.example                 # Environment template
â”œâ”€â”€ mcp-config.example.json      # MCP config template
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

---

## ğŸ› Troubleshooting

### Common Issues

#### "MCP server not connected"

```bash
# Check if tokens are set
echo $GITHUB_PERSONAL_ACCESS_TOKEN
echo $NOTION_API_TOKEN

# Test GitHub token
curl -H "Authorization: token $GITHUB_PERSONAL_ACCESS_TOKEN" https://api.github.com/user
```

#### "RAG returns 0 results"

```bash
# Check indexed document count in logs
# Should see: "Vector store initialized (254 documents)"

# Invite bot to more channels
/invite @YourBotName

# Restart to re-index
npm run dev
```

#### "Memory not working"

```
# Check for this warning in logs:
"Failed to initialize client: ReferenceError: window is not defined"

# This is a known mem0 package issue - memory still works via API
```

#### "Bot not responding in channels"

1. Ensure bot is mentioned: `@BotName your message`
2. Check bot is invited to the channel
3. Check `ALLOWED_CHANNELS` in config

#### "Tool not being used"

The LLM decides when to use tools. Be explicit:
```
âŒ "What repos do I have?"
âœ… "Use GitHub to list my repositories"
âœ… "Search my GitHub repos for VizuaraAI"
```

### Debug Mode

Enable verbose logging:
```env
LOG_LEVEL=debug
```

### Logs to Check

```
# Startup
âœ… MCP initialized: github, notion     # MCP working
âœ… Vector store initialized (254 docs) # RAG working
âœ… Memory system initialized           # Memory working

# Message processing
Total tools available: 59 (12 Slack + 47 MCP)  # All tools loaded
Executing tool: github_create_issue            # Tool being called
Executing MCP tool: github/create_issue        # MCP routing
Stored 1 memories for user U050Y4SNQF3         # Memory saving
```

---

## ğŸ¤ Contributing

Contributions are welcome! Please:

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/amazing-feature`
3. Commit changes: `git commit -m 'Add amazing feature'`
4. Push to branch: `git push origin feature/amazing-feature`
5. Open a Pull Request

### Development

```bash
# Install dependencies
npm install

# Run in development mode
npm run dev

# Type checking
npm run typecheck

# Linting
npm run lint
```

---

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ™ Acknowledgments

- [Slack Bolt.js](https://slack.dev/bolt-js/) - Slack app framework
- [OpenAI](https://openai.com/) - LLM and embeddings
- [mem0](https://mem0.ai/) - Long-term memory
- [Model Context Protocol](https://modelcontextprotocol.io/) - Tool integration standard
- [ChromaDB](https://www.trychroma.com/) - Vector database

---

<p align="center">
  Built with â¤ï¸ for productive Slack workspaces
</p>
